<% provide(:title, @recipe.title + " by " + @recipe.user.name) %>

<div class="row">
  <div class="col-md-12">
    <div class="main-img-wrapper">
      <%= image_tag(@recipe.image_url.url, alt: @recipe.title, class: "img") if @recipe.image_url? %>
    </div><!-- /.main-img-wrapper -->
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <div id="recipe-panel" class="panel panel-info center-block">
          <div class="panel-heading">
            <h1 class="panel-title"><%= @recipe.title %> | <small><%= link_to @recipe.user.name, @recipe.user %></small></h1>
            <% if logged_in? && (@recipe.user_id == current_user.id || current_user.admin?) %>
              <div class="recipe-buttons pull-right">
                <%= link_to "Edit", edit_recipe_path, class: "btn btn-primary btn-sm", role: "button" %>
                <%= link_to "Delete", @recipe, method: :delete, class: "btn btn-danger btn-sm", role: "button", data: { confirm: "Are you sure you want to delete this recipe?" } %>
              </div> <!-- /.recipe-buttons -->
            <% end %>
          </div><!-- /.panel-heading -->
          <div class="panel-body">
            <div class="row">
              <div class="col-sm-6">
                <p>Prep time: <%= @recipe.prep_time %> mins</p>
                <p>Cook time: <%= @recipe.cook_time %> mins</p>
              </div>
              <div class="col-sm-6">
                <h3>Total time: <%= @recipe.prep_time + @recipe.cook_time %> mins</h3>
              </div>
            </div>
          </div><!-- /.panel-body -->
        </div><!-- /.panel -->
      </div><!-- /.col-md-8 -->
    </div><!-- /.row -->
  </div><!-- /.col-md-12" -->
</div><!-- /.row -->

<div class="row">
  <div class="col-md-8">
    <p class="lead"><%= @recipe.description %></p>
  </div><!-- /.col-md-8 --> 
  <div class="col-md-4">
    <div class="well well-sm">Servings: <%= @recipe.servings %></div>
  </div> 
  <hr/>
</div><!-- /.row -->
    
<div class="row">
  <div class="col-md-8">    
    <h3>Directions:</h3>
    <% if @recipe.steps.any? %>
      <ol class="steps">
        <%= render @steps %>
      </ol>
    <% else %>
      <h4>No instructions provided</h4>
    <% end %>
  </div><!-- /.col-md-8 -->
  <div class="col-md-4">
    <h3>Ingredients:</h3>
    <% if @recipe.ingredients.any? %>
      <ul class="ingredients list-group">
        <%= render @ingredients %>
      </ul>
    <% else %>
      <h4>No ingredients provided</h4>
    <% end %>
  </div><!-- /.col-md-4 -->
</div><!-- /.row -->

<div class="row">
  <div class="col-md-12">
    <h2>Reviews</h2>
    <div class="row">
      <% if @recipe.reviews.any? %>
        <%= render @reviews %>
        <%= will_paginate @reviews %>
      <% else %>
        <div class="col-md-12">
          <h3>No reviews yet.</h3>
        </div><!-- /.col-md-12 -->
      <% end %>
    </div><!-- /.row -->
  </div><!-- /.col-md-12 -->
</div><!-- /.row -->

<div class="row">
  <div class="col-sm-12">
    <% if logged_in? && review_exists?(@recipe) %>
      <h4>Change your review:</h4>
    <% else %>
      <h4>Leave a review:</h4>
    <% end %>
  </div><!-- /.col-sm-12 -->
</div><!-- ./row -->

<% if logged_in? %>  
  <div class="row">
    <div class="col-sm-6">
      <%= render 'reviews/review_form' %>
    </div>
    <div class="col-sm-6">
      <p>PLUG SOMETHING ELSE HERE</p>
    </div>
  </div>
<% else %>
  <div class="row">
    <div class="col-sm-12">
      <%= link_to "Log in to leave a review", login_path, :class => "btn btn-primary", :role => "button" %>
    </div><!-- /.col-sm-12 -->
  </div><!-- /.row -->
<% end %>